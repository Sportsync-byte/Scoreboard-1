<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indoor Cricket Umpire Interface</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a1a;
            color: white;
            margin: 0;
            padding: 1rem;
            min-height: 100vh;
        }

        .game-controls {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .score-button {
            font-size: 1.5rem;
            padding: 1rem;
            border: none;
            border-radius: 8px;
            background-color: #2a2a2a;
            color: white;
            transition: all 0.2s ease;
        }

        .score-button:hover {
            transform: scale(1.05);
            background-color: #3a3a3a;
        }

        .score-button:active {
            transform: scale(0.95);
        }

        .wicket-button {
            background-color: #dc3545;
        }

        .extras-button {
            background-color: #ffc107;
            color: black;
        }

        .control-button {
            background-color: #28a745;
        }

        .game-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .info-box {
            background-color: #2a2a2a;
            padding: 1rem;
            border-radius: 8px;
        }

        .partnership-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .ball-history {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .ball {
            padding: 0.5rem;
            border-radius: 4px;
            background-color: #3a3a3a;
            min-width: 40px;
            text-align: center;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }

        .modal-content {
            background-color: #2a2a2a;
            margin: 15% auto;
            padding: 1rem;
            border-radius: 8px;
            width: 80%;
            max-width: 500px;
        }

        .close-modal {
            float: right;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-control {
            width: 100%;
            padding: 0.5rem;
            margin-bottom: 0.5rem;
            background-color: #3a3a3a;
            border: none;
            border-radius: 4px;
            color: white;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .btn-primary {
            background-color: #007bff;
            color: white;
        }

        .timer-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .timer-button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            background-color: #28a745;
            color: white;
        }

        .pause-button {
            background-color: #dc3545;
        }

        @media (max-width: 768px) {
            .game-controls {
                grid-template-columns: repeat(3, 1fr);
            }

            .game-info {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .game-controls {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Game Info Section -->
        <div class="game-info">
            <div class="info-box">
                <h3>Match Info</h3>
                <p>Batting: <span id="battingTeam">Team A</span></p>
                <p>Score: <span id="currentScore">0</span>/<span id="wickets">0</span></p>
                <p>Over: <span id="currentOver">0.0</span>/<span id="totalOvers">16.0</span></p>
            </div>
            <div class="info-box">
                <h3>Partnership Info</h3>
                <div class="partnership-info">
                    <p>Current: <span id="partnershipScore">0</span></p>
                    <p>Partnership: <span id="currentPartnership">1</span>/4</p>
                </div>
                <div id="batsmenInfo">
                    <p>Batsman 1: <span id="batsman1">-</span></p>
                    <p>Batsman 2: <span id="batsman2">-</span></p>
                </div>
            </div>
        </div>

        <!-- Ball History -->
        <div class="ball-history" id="ballHistory"></div>

        <!-- Game Controls -->
        <div class="game-controls">
            <button class="score-button" onclick="addRuns(0)">0</button>
            <button class="score-button" onclick="addRuns(1)">1</button>
            <button class="score-button" onclick="addRuns(2)">2</button>
            <button class="score-button" onclick="addRuns(3)">3</button>
            <button class="score-button" onclick="addRuns(4)">4</button>
            <button class="score-button" onclick="addRuns(5)">5</button>
            <button class="score-button" onclick="addRuns(6)">6</button>
            <button class="score-button" onclick="addRuns(7)">7</button>
            <button class="score-button wicket-button" onclick="addWicket('bowled')">BOWLED</button>
            <button class="score-button wicket-button" onclick="addWicket('caught')">CAUGHT</button>
            <button class="score-button wicket-button" onclick="addWicket('runout')">RUN OUT</button>
            <button class="score-button wicket-button" onclick="addWicket('stumped')">STUMPED</button>
            <button class="score-button wicket-button" onclick="addWicket('hitwicket')">HIT WICKET</button>
            <button class="score-button wicket-button" onclick="addWicket('obstruction')">OBSTRUCTION</button>
            <button class="score-button wicket-button" onclick="addWicket('thirdball')">THIRD BALL</button>
            <button class="score-button extras-button" onclick="showExtrasModal()">EXTRAS</button>
            <button class="score-button control-button" onclick="undoLastBall()">UNDO</button>
            <button class="score-button control-button" onclick="addBallToOver()">ADD BALL</button>
            <button class="score-button control-button" onclick="startNewOver()">NEXT OVER</button>
        </div>
                <!-- Timer Controls -->
        <div class="timer-controls">
            <button class="timer-button" id="startTimer" onclick="startTimer()">Start Timer</button>
            <button class="timer-button pause-button" id="pauseTimer" onclick="pauseTimer()">Pause Timer</button>
            <span id="timerDisplay">00:00</span>
        </div>

        <!-- Batsmen Modal -->
        <div id="batsmenModal" class="modal">
            <div class="modal-content">
                <span class="close-modal" onclick="closeBatsmenModal()">&times;</span>
                <h3>Enter Batsmen Names</h3>
                <div class="form-group">
                    <label>Striker:</label>
                    <input type="text" id="strikerName" class="form-control">
                </div>
                <div class="form-group">
                    <label>Non-Striker:</label>
                    <input type="text" id="nonStrikerName" class="form-control">
                </div>
                <button onclick="confirmBatsmen()" class="btn btn-primary">Confirm</button>
            </div>
        </div>

        <!-- Bowler Modal -->
        <div id="bowlerModal" class="modal">
            <div class="modal-content">
                <span class="close-modal" onclick="closeBowlerModal()">&times;</span>
                <h3>Enter Bowler Name</h3>
                <div class="form-group">
                    <label>Bowler:</label>
                    <input type="text" id="bowlerName" class="form-control">
                </div>
                <button onclick="confirmBowler()" class="btn btn-primary">Confirm</button>
            </div>
        </div>

        <!-- Extras Modal -->
        <div id="extrasModal" class="modal">
            <div class="modal-content">
                <span class="close-modal" onclick="closeExtrasModal()">&times;</span>
                <h3>Select Extras Type</h3>
                <button class="extras-type-button" onclick="addExtras('wide')">Wide</button>
                <button class="extras-type-button" onclick="addExtras('noball')">No Ball</button>
                <button class="extras-type-button" onclick="addExtras('penalty')">Penalty</button>
            </div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            battingTeam: '',
            fieldingTeam: '',
            currentScore: 0,
            wickets: 0,
            currentOver: 0,
            totalOvers: 16,
            currentPartnership: 0,
            partnerships: [],
            currentBatsmen: {
                striker: null,
                nonStriker: null,
                strikerRuns: 0,
                nonStrikerRuns: 0
            },
            currentBowler: {
                name: null,
                overs: 0,
                runs: 0,
                wickets: 0
            },
            bowlerFigures: [],
            ballHistory: [],
            timer: {
                isRunning: false,
                startTime: 0,
                elapsed: 0,
                duration: 0
            }
        };

        // Initialize Game
        function initializeGame() {
            const savedState = localStorage.getItem('indoorCricketGame');
            if (savedState) {
                gameState = JSON.parse(savedState);
                updateDisplay();
                updateBallHistory();
            }
            handleNewPartnership();
        }

        // Update Display
        function updateDisplay() {
            document.getElementById('battingTeam').textContent = gameState.battingTeam;
            document.getElementById('currentScore').textContent = gameState.currentScore;
            document.getElementById('wickets').textContent = gameState.wickets;
            document.getElementById('currentOver').textContent = gameState.currentOver.toFixed(1);
            document.getElementById('totalOvers').textContent = gameState.totalOvers.toFixed(1);
            document.getElementById('partnershipScore').textContent = 
                gameState.partnerships[gameState.currentPartnership]?.score || 0;
            document.getElementById('currentPartnership').textContent = 
                (gameState.currentPartnership + 1);
            
            document.getElementById('batsman1').textContent = 
                `${gameState.currentBatsmen.striker} (${gameState.currentBatsmen.strikerRuns}*)`;
            document.getElementById('batsman2').textContent = 
                `${gameState.currentBatsmen.nonStriker} (${gameState.currentBatsmen.nonStrikerRuns})`;

            localStorage.setItem('indoorCricketGame', JSON.stringify(gameState));
        }

        // Add Runs
        function addRuns(runs) {
            if (gameState.wickets >= 8) return;
            
            gameState.currentScore += runs;
            if (gameState.partnerships[gameState.currentPartnership]) {
                gameState.partnerships[gameState.currentPartnership].score += runs;
                gameState.partnerships[gameState.currentPartnership].balls = 
                    (gameState.partnerships[gameState.currentPartnership].balls || 0) + 1;
            }

            gameState.currentBatsmen.strikerRuns += runs;
            if (gameState.currentBowler) {
                gameState.currentBowler.runs += runs;
            }

            const ball = {
                type: 'runs',
                value: runs,
                over: gameState.currentOver,
                bowler: gameState.currentBowler?.name,
                batsman: gameState.currentBatsmen.striker
            };
            gameState.ballHistory.push(ball);

            incrementOver();
            updateDisplay();
            updateBallHistory();
        }

        // Add ball to over
        function addBallToOver() {
            const currentBalls = Math.round((gameState.currentOver % 1) * 10);
            if (currentBalls < 5) {
                gameState.currentOver = Math.floor(gameState.currentOver) + 
                    ((currentBalls + 1) / 10);
                updateDisplay();
                updateBallHistory();
            } else {
                alert('Over is already complete. Please use "Next Over" button.');
            }
        }

        // Start new over
        function startNewOver() {
            document.getElementById('bowlerModal').style.display = 'block';
            gameState.currentOver = Math.ceil(gameState.currentOver);
            
            if (gameState.currentBowler) {
                if (!gameState.bowlerFigures) {
                    gameState.bowlerFigures = [];
                }
                gameState.bowlerFigures.push({
                    name: gameState.currentBowler.name,
                    overs: gameState.currentBowler.overs,
                    runs: gameState.currentBowler.runs,
                    wickets: gameState.currentBowler.wickets
                });
            }

            rotateStrike();
            updateDisplay();
        }

        // Increment Over
        function incrementOver() {
            const currentBalls = Math.round((gameState.currentOver % 1) * 10);
            if (currentBalls < 5) {
                gameState.currentOver = Math.floor(gameState.currentOver) + 
                    ((currentBalls + 1) / 10);
            }
        }

        // Handle Batsmen Modal
        function handleNewPartnership() {
            document.getElementById('batsmenModal').style.display = 'block';
        }

        function closeBatsmenModal() {
            document.getElementById('batsmenModal').style.display = 'none';
        }

        function confirmBatsmen() {
            const striker = document.getElementById('strikerName').value;
            const nonStriker = document.getElementById('nonStrikerName').value;
            
            if (!striker || !nonStriker) {
                alert('Please enter both batsmen names');
                return;
            }

            gameState.currentBatsmen = {
                striker: striker,
                nonStriker: nonStriker,
                strikerRuns: 0,
                nonStrikerRuns: 0
            };

            if (gameState.partnerships[gameState.currentPartnership]) {
                gameState.partnerships[gameState.currentPartnership].batsmen = [striker, nonStriker];
                gameState.partnerships[gameState.currentPartnership].balls = 0;
            } else {
                gameState.partnerships[gameState.currentPartnership] = {
                    score: 0,
                    balls: 0,
                    batsmen: [striker, nonStriker]
                };
            }

            closeBatsmenModal();
            updateDisplay();
        }

        // Handle Bowler Modal
        function closeBowlerModal() {
            document.getElementById('bowlerModal').style.display = 'none';
        }

        function confirmBowler() {
            const bowler = document.getElementById('bowlerName').value;
            
            if (!bowler) {
                alert('Please enter bowler name');
                return;
            }

            gameState.currentBowler = {
                name: bowler,
                overs: 0,
                runs: 0,
                wickets: 0
            };

            closeBowlerModal();
            updateDisplay();
        }

        // Add Wicket
        function addWicket(type) {
            if (gameState.wickets >= 8) return;

            gameState.wickets++;
            
            if (gameState.currentBowler) {
                gameState.currentBowler.wickets++;
            }

            const ball = {
                type: 'wicket',
                wicketType: type,
                over: gameState.currentOver,
                bowler: gameState.currentBowler?.name,
                batsman: gameState.currentBatsmen.striker,
                batsmanRuns: gameState.currentBatsmen.strikerRuns
            };
            gameState.ballHistory.push(ball);

            incrementOver();
            updateDisplay();
            updateBallHistory();
            checkPartnershipEnd();
        }

        // Add Extras
        function addExtras(type) {
            let runs = 1;
            if (type === 'penalty') runs = 5;

            gameState.currentScore += runs;
            if (gameState.partnerships[gameState.currentPartnership]) {
                gameState.partnerships[gameState.currentPartnership].score += runs;
            }

            if (gameState.currentBowler && type !== 'penalty') {
                gameState.currentBowler.runs += runs;
            }

            const ball = {
                type: 'extras',
                extrasType: type,
                value: runs,
                over: gameState.currentOver,
                bowler: gameState.currentBowler?.name
            };
            gameState.ballHistory.push(ball);

            if (type !== 'noball') {
                incrementOver();
            }

            closeExtrasModal();
            updateDisplay();
            updateBallHistory();
        }

        function closeExtrasModal() {
            document.getElementById('extrasModal').style.display = 'none';
        }

        function showExtrasModal() {
            document.getElementById('extrasModal').style.display = 'block';
        }

        // Rotate Strike
        function rotateStrike() {
            if (gameState.currentBatsmen.striker && gameState.currentBatsmen.nonStriker) {
                [gameState.currentBatsmen.striker, gameState.currentBatsmen.nonStriker] = 
                    [gameState.currentBatsmen.nonStriker, gameState.currentBatsmen.striker];
                [gameState.currentBatsmen.strikerRuns, gameState.currentBatsmen.nonStrikerRuns] = 
                    [gameState.currentBatsmen.nonStrikerRuns, gameState.currentBatsmen.strikerRuns];
            }
        }

        // Check Partnership End
        function checkPartnershipEnd() {
            const currentPartnershipScore = 
                gameState.partnerships[gameState.currentPartnership]?.score || 0;
            if (currentPartnershipScore >= 20 || 
                (gameState.wickets > 0 && gameState.wickets % 2 === 0)) {
                if (gameState.currentPartnership < 3) {
                    gameState.currentPartnership++;
                    gameState.partnerships[gameState.currentPartnership] = { 
                        score: 0,
                        balls: 0,
                        batsmen: []
                    };
                    handleNewPartnership();
                }
            }
        }

        // Update Ball History
        function updateBallHistory() {
            const container = document.getElementById('ballHistory');
            container.innerHTML = '';

            const currentOverBalls = gameState.ballHistory.filter(
                ball => Math.floor(ball.over) === Math.floor(gameState.currentOver)
            );

            currentOverBalls.forEach(ball => {
                const ballElement = document.createElement('div');
                ballElement.className = 'ball';
                
                switch (ball.type) {
                    case 'runs':
                        ballElement.textContent = ball.value;
                        ballElement.style.backgroundColor = '#28a745';
                        break;
                    case 'wicket':
                        ballElement.textContent = 'W';
                        ballElement.style.backgroundColor = '#dc3545';
                        break;
                    case 'extras':
                        ballElement.textContent = ball.extrasType[0].toUpperCase();
                        ballElement.style.backgroundColor = '#ffc107';
                        break;
                }

                container.appendChild(ballElement);
            });
        }

        // Timer Functions
        function startTimer() {
            if (!gameState.timer.isRunning) {
                gameState.timer.isRunning = true;
                gameState.timer.startTime = Date.now() - gameState.timer.elapsed;
                updateTimer();
            }
        }

        function pauseTimer() {
            if (gameState.timer.isRunning) {
                gameState.timer.isRunning = false;
                gameState.timer.elapsed = Date.now() - gameState.timer.startTime;
                updateDisplay();
            }
        }

        function updateTimer() {
            if (gameState.timer.isRunning) {
                const elapsed = Date.now() - gameState.timer.startTime;
                const remaining = Math.max(0, gameState.timer.duration * 60 * 1000 - elapsed);
                
                const minutes = Math.floor(remaining / 60000);
                const seconds = Math.floor((remaining % 60000) / 1000);
                
                document.getElementById('timerDisplay').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (remaining > 0) {
                    requestAnimationFrame(updateTimer);
                }
            }
        }

        // Undo Last Ball
        function undoLastBall() {
            if (gameState.ballHistory.length === 0) return;

            const lastBall = gameState.ballHistory.pop();
            
            switch (lastBall.type) {
                case 'runs':
                    gameState.currentScore -= lastBall.value;
                    if (gameState.partnerships[gameState.currentPartnership]) {
                        gameState.partnerships[gameState.currentPartnership].score -= lastBall.value;
                        gameState.partnerships[gameState.currentPartnership].balls--;
                    }
                    if (gameState.currentBowler) {
                        gameState.currentBowler.runs -= lastBall.value;
                    }
                    gameState.currentBatsmen.strikerRuns -= lastBall.value;
                    break;
                case 'wicket':
                    gameState.wickets--;
                    if (gameState.currentBowler) {
                        gameState.currentBowler.wickets--;
                    }
                    break;
                case 'extras':
                    gameState.currentScore -= lastBall.value;
                    if (gameState.partnerships[gameState.currentPartnership]) {
                        gameState.partnerships[gameState.currentPartnership].score -= lastBall.value;
                    }
                    if (gameState.currentBowler && lastBall.extrasType !== 'penalty') {
                        gameState.currentBowler.runs -= lastBall.value;
                    }
                    break;
            }

            gameState.currentOver = lastBall.over;
            updateDisplay();
            updateBallHistory();
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeGame);
    </script>
</body>
</html>
